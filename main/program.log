2023-09-15 02:37:55,972 - _welcome - INFO - Bot: Azur [@automatic_azur_bot]
2023-09-15 02:37:56,123 - _skip_updates - WARNING - Updates were skipped successfully.
2023-09-15 02:37:56,123 - start_polling - INFO - Start polling.
2023-09-15 02:38:12,018 - default_exception_handler - ERROR - Task exception was never retrieved
future: <Task finished name='Task-9' coro=<Dispatcher._process_polling_updates() done, defined at c:\Users\Alti\Desktop\Dev\ТЕСТОВЫЕ\Technesis\TG_bot_pars_data_exel\venv\lib\site-packages\aiogram\dispatcher\dispatcher.py:407> exception=OperationalError('table users has no column named type')>
Traceback (most recent call last):
  File "c:\Users\Alti\Desktop\Dev\ТЕСТОВЫЕ\Technesis\TG_bot_pars_data_exel\venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 415, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "c:\Users\Alti\Desktop\Dev\ТЕСТОВЫЕ\Technesis\TG_bot_pars_data_exel\venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 235, in process_updates
    return await asyncio.gather(*tasks)
  File "c:\Users\Alti\Desktop\Dev\ТЕСТОВЫЕ\Technesis\TG_bot_pars_data_exel\venv\lib\site-packages\aiogram\dispatcher\handler.py", line 117, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Alti\Desktop\Dev\ТЕСТОВЫЕ\Technesis\TG_bot_pars_data_exel\venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 256, in process_update
    return await self.message_handlers.notify(update.message)
  File "c:\Users\Alti\Desktop\Dev\ТЕСТОВЫЕ\Technesis\TG_bot_pars_data_exel\venv\lib\site-packages\aiogram\dispatcher\handler.py", line 117, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\Users\Alti\Desktop\Dev\ТЕСТОВЫЕ\Technesis\TG_bot_pars_data_exel\main\main.py", line 94, in send_welcome
    added_user(message['from'])
  File "C:\Users\Alti\Desktop\Dev\ТЕСТОВЫЕ\Technesis\TG_bot_pars_data_exel\main\database\create_user_profile.py", line 12, in added_user
    cur.execute('''
sqlite3.OperationalError: table users has no column named type
2023-09-15 02:38:55,756 - _welcome - INFO - Bot: Azur [@automatic_azur_bot]
2023-09-15 02:38:55,909 - _skip_updates - WARNING - Updates were skipped successfully.
2023-09-15 02:38:55,910 - start_polling - INFO - Start polling.
2023-09-15 02:41:57,285 - default_exception_handler - ERROR - Task exception was never retrieved
future: <Task finished name='Task-23' coro=<Dispatcher._process_polling_updates() done, defined at c:\Users\Alti\Desktop\Dev\ТЕСТОВЫЕ\Technesis\TG_bot_pars_data_exel\venv\lib\site-packages\aiogram\dispatcher\dispatcher.py:407> exception=ProgrammingError('Cannot operate on a closed database.')>
Traceback (most recent call last):
  File "c:\Users\Alti\Desktop\Dev\ТЕСТОВЫЕ\Technesis\TG_bot_pars_data_exel\venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 415, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "c:\Users\Alti\Desktop\Dev\ТЕСТОВЫЕ\Technesis\TG_bot_pars_data_exel\venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 235, in process_updates
    return await asyncio.gather(*tasks)
  File "c:\Users\Alti\Desktop\Dev\ТЕСТОВЫЕ\Technesis\TG_bot_pars_data_exel\venv\lib\site-packages\aiogram\dispatcher\handler.py", line 117, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Alti\Desktop\Dev\ТЕСТОВЫЕ\Technesis\TG_bot_pars_data_exel\venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 256, in process_update
    return await self.message_handlers.notify(update.message)
  File "c:\Users\Alti\Desktop\Dev\ТЕСТОВЫЕ\Technesis\TG_bot_pars_data_exel\venv\lib\site-packages\aiogram\dispatcher\handler.py", line 117, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\Users\Alti\Desktop\Dev\ТЕСТОВЫЕ\Technesis\TG_bot_pars_data_exel\main\main.py", line 94, in send_welcome
    added_user(message['from'])
  File "C:\Users\Alti\Desktop\Dev\ТЕСТОВЫЕ\Technesis\TG_bot_pars_data_exel\main\database\create_user_profile.py", line 12, in added_user
    cur.execute('''
sqlite3.ProgrammingError: Cannot operate on a closed database.
2023-09-15 02:43:14,839 - _welcome - INFO - Bot: Azur [@automatic_azur_bot]
2023-09-15 02:43:14,991 - _skip_updates - WARNING - Updates were skipped successfully.
2023-09-15 02:43:14,992 - start_polling - INFO - Start polling.
2023-09-15 02:48:22,954 - _welcome - INFO - Bot: Azur [@automatic_azur_bot]
2023-09-15 02:48:23,105 - _skip_updates - WARNING - Updates were skipped successfully.
2023-09-15 02:48:23,105 - start_polling - INFO - Start polling.
2023-09-15 02:49:37,870 - _welcome - INFO - Bot: Azur [@automatic_azur_bot]
2023-09-15 02:49:38,030 - _skip_updates - WARNING - Updates were skipped successfully.
2023-09-15 02:49:38,030 - start_polling - INFO - Start polling.
2023-09-15 02:50:55,906 - default_exception_handler - ERROR - Task exception was never retrieved
future: <Task finished name='Task-17' coro=<Dispatcher._process_polling_updates() done, defined at c:\Users\Alti\Desktop\Dev\ТЕСТОВЫЕ\Technesis\TG_bot_pars_data_exel\venv\lib\site-packages\aiogram\dispatcher\dispatcher.py:407> exception=IntegrityError('UNIQUE constraint failed: users.telegram_id')>
Traceback (most recent call last):
  File "c:\Users\Alti\Desktop\Dev\ТЕСТОВЫЕ\Technesis\TG_bot_pars_data_exel\venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 415, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "c:\Users\Alti\Desktop\Dev\ТЕСТОВЫЕ\Technesis\TG_bot_pars_data_exel\venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 235, in process_updates
    return await asyncio.gather(*tasks)
  File "c:\Users\Alti\Desktop\Dev\ТЕСТОВЫЕ\Technesis\TG_bot_pars_data_exel\venv\lib\site-packages\aiogram\dispatcher\handler.py", line 117, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Alti\Desktop\Dev\ТЕСТОВЫЕ\Technesis\TG_bot_pars_data_exel\venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 256, in process_update
    return await self.message_handlers.notify(update.message)
  File "c:\Users\Alti\Desktop\Dev\ТЕСТОВЫЕ\Technesis\TG_bot_pars_data_exel\venv\lib\site-packages\aiogram\dispatcher\handler.py", line 117, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\Users\Alti\Desktop\Dev\ТЕСТОВЫЕ\Technesis\TG_bot_pars_data_exel\main\main.py", line 94, in send_welcome
    added_user(message['from'])
  File "C:\Users\Alti\Desktop\Dev\ТЕСТОВЫЕ\Technesis\TG_bot_pars_data_exel\main\database\create_user_profile.py", line 10, in added_user
    cur.execute('''
sqlite3.IntegrityError: UNIQUE constraint failed: users.telegram_id
2023-09-15 02:58:08,062 - _welcome - INFO - Bot: Azur [@automatic_azur_bot]
2023-09-15 02:58:08,205 - _skip_updates - WARNING - Updates were skipped successfully.
2023-09-15 02:58:08,206 - start_polling - INFO - Start polling.
2023-09-15 02:59:06,713 - _welcome - INFO - Bot: Azur [@automatic_azur_bot]
2023-09-15 02:59:06,846 - _skip_updates - WARNING - Updates were skipped successfully.
2023-09-15 02:59:06,847 - start_polling - INFO - Start polling.
2023-09-15 03:38:07,809 - _welcome - INFO - Bot: Azur [@automatic_azur_bot]
2023-09-15 03:38:07,967 - _skip_updates - WARNING - Updates were skipped successfully.
2023-09-15 03:38:07,967 - start_polling - INFO - Start polling.
2023-09-15 03:38:25,937 - _welcome - INFO - Bot: Azur [@automatic_azur_bot]
2023-09-15 03:38:26,087 - _skip_updates - WARNING - Updates were skipped successfully.
2023-09-15 03:38:26,088 - start_polling - INFO - Start polling.
2023-09-15 03:39:23,810 - _welcome - INFO - Bot: Azur [@automatic_azur_bot]
2023-09-15 03:39:23,964 - _skip_updates - WARNING - Updates were skipped successfully.
2023-09-15 03:39:23,965 - start_polling - INFO - Start polling.
2023-09-15 03:40:43,228 - parse_date - ERROR - Произошла ошибка при обработке файла: 'title_column'
2023-09-15 03:40:43,230 - default_exception_handler - ERROR - Task exception was never retrieved
future: <Task finished name='Task-14' coro=<Dispatcher._process_polling_updates() done, defined at c:\Users\Alti\Desktop\Dev\ТЕСТОВЫЕ\Technesis\TG_bot_pars_data_exel\venv\lib\site-packages\aiogram\dispatcher\dispatcher.py:407> exception=TypeError("object NoneType can't be used in 'await' expression")>
Traceback (most recent call last):
  File "c:\Users\Alti\Desktop\Dev\ТЕСТОВЫЕ\Technesis\TG_bot_pars_data_exel\venv\lib\site-packages\pandas\core\indexes\base.py", line 3790, in get_loc
    return self._engine.get_loc(casted_key)
  File "index.pyx", line 152, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 181, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'title_column'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Alti\Desktop\Dev\ТЕСТОВЫЕ\Technesis\TG_bot_pars_data_exel\main\main.py", line 80, in parse_date
    await added_parse_date(message['from'], df)
  File "C:\Users\Alti\Desktop\Dev\ТЕСТОВЫЕ\Technesis\TG_bot_pars_data_exel\main\database\insert_data_db.py", line 14, in added_parse_date
    title = row['title_column']  # Замените 'title_column' на имя колонки с заголовками
  File "c:\Users\Alti\Desktop\Dev\ТЕСТОВЫЕ\Technesis\TG_bot_pars_data_exel\venv\lib\site-packages\pandas\core\series.py", line 1040, in __getitem__
    return self._get_value(key)
  File "c:\Users\Alti\Desktop\Dev\ТЕСТОВЫЕ\Technesis\TG_bot_pars_data_exel\venv\lib\site-packages\pandas\core\series.py", line 1156, in _get_value
    loc = self.index.get_loc(label)
  File "c:\Users\Alti\Desktop\Dev\ТЕСТОВЫЕ\Technesis\TG_bot_pars_data_exel\venv\lib\site-packages\pandas\core\indexes\base.py", line 3797, in get_loc
    raise KeyError(key) from err
KeyError: 'title_column'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\Alti\Desktop\Dev\ТЕСТОВЫЕ\Technesis\TG_bot_pars_data_exel\venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 415, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "c:\Users\Alti\Desktop\Dev\ТЕСТОВЫЕ\Technesis\TG_bot_pars_data_exel\venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 235, in process_updates
    return await asyncio.gather(*tasks)
  File "c:\Users\Alti\Desktop\Dev\ТЕСТОВЫЕ\Technesis\TG_bot_pars_data_exel\venv\lib\site-packages\aiogram\dispatcher\handler.py", line 117, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Alti\Desktop\Dev\ТЕСТОВЫЕ\Technesis\TG_bot_pars_data_exel\venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 256, in process_update
    return await self.message_handlers.notify(update.message)
  File "c:\Users\Alti\Desktop\Dev\ТЕСТОВЫЕ\Technesis\TG_bot_pars_data_exel\venv\lib\site-packages\aiogram\dispatcher\handler.py", line 117, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\Users\Alti\Desktop\Dev\ТЕСТОВЫЕ\Technesis\TG_bot_pars_data_exel\main\main.py", line 82, in parse_date
    await logging.error(
TypeError: object NoneType can't be used in 'await' expression
2023-09-15 03:41:18,130 - _welcome - INFO - Bot: Azur [@automatic_azur_bot]
2023-09-15 03:41:18,278 - _skip_updates - WARNING - Updates were skipped successfully.
2023-09-15 03:41:18,279 - start_polling - INFO - Start polling.
2023-09-15 03:41:34,103 - _welcome - INFO - Bot: Azur [@automatic_azur_bot]
2023-09-15 03:41:34,242 - _skip_updates - WARNING - Updates were skipped successfully.
2023-09-15 03:41:34,243 - start_polling - INFO - Start polling.
2023-09-15 03:42:51,050 - parse_date - ERROR - Произошла ошибка при обработке файла: object NoneType can't be used in 'await' expression
2023-09-15 03:42:51,052 - default_exception_handler - ERROR - Task exception was never retrieved
future: <Task finished name='Task-14' coro=<Dispatcher._process_polling_updates() done, defined at c:\Users\Alti\Desktop\Dev\ТЕСТОВЫЕ\Technesis\TG_bot_pars_data_exel\venv\lib\site-packages\aiogram\dispatcher\dispatcher.py:407> exception=TypeError("object NoneType can't be used in 'await' expression")>
Traceback (most recent call last):
  File "C:\Users\Alti\Desktop\Dev\ТЕСТОВЫЕ\Technesis\TG_bot_pars_data_exel\main\main.py", line 80, in parse_date
    await added_parse_date(message['from'], df)
TypeError: object NoneType can't be used in 'await' expression

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\Alti\Desktop\Dev\ТЕСТОВЫЕ\Technesis\TG_bot_pars_data_exel\venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 415, in _process_polling_updates
    for responses in itertools.chain.from_iterable(await self.process_updates(updates, fast)):
  File "c:\Users\Alti\Desktop\Dev\ТЕСТОВЫЕ\Technesis\TG_bot_pars_data_exel\venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 235, in process_updates
    return await asyncio.gather(*tasks)
  File "c:\Users\Alti\Desktop\Dev\ТЕСТОВЫЕ\Technesis\TG_bot_pars_data_exel\venv\lib\site-packages\aiogram\dispatcher\handler.py", line 117, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "c:\Users\Alti\Desktop\Dev\ТЕСТОВЫЕ\Technesis\TG_bot_pars_data_exel\venv\lib\site-packages\aiogram\dispatcher\dispatcher.py", line 256, in process_update
    return await self.message_handlers.notify(update.message)
  File "c:\Users\Alti\Desktop\Dev\ТЕСТОВЫЕ\Technesis\TG_bot_pars_data_exel\venv\lib\site-packages\aiogram\dispatcher\handler.py", line 117, in notify
    response = await handler_obj.handler(*args, **partial_data)
  File "C:\Users\Alti\Desktop\Dev\ТЕСТОВЫЕ\Technesis\TG_bot_pars_data_exel\main\main.py", line 82, in parse_date
    await logging.error(
TypeError: object NoneType can't be used in 'await' expression
2023-09-15 03:45:52,964 - _welcome - INFO - Bot: Azur [@automatic_azur_bot]
2023-09-15 03:45:53,114 - _skip_updates - WARNING - Updates were skipped successfully.
2023-09-15 03:45:53,114 - start_polling - INFO - Start polling.
2023-09-15 03:51:05,232 - _welcome - INFO - Bot: Azur [@automatic_azur_bot]
2023-09-15 03:51:05,382 - _skip_updates - WARNING - Updates were skipped successfully.
2023-09-15 03:51:05,383 - start_polling - INFO - Start polling.
